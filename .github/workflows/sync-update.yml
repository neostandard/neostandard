name: Refresh dependents data

on:
  schedule:
    # At 04:23 on day-of-month 6: https://crontab.guru/#23_4_6_*_*
    - cron: '23 4 6 * *'
  workflow_dispatch:

concurrency:
  group: ${{ github.workflow }}-${{ github.head_ref || github.run_id }}

permissions:
  contents: write
  pull-requests: write

jobs:
  sync:
    name: Update dependents data
    uses: ./.github/workflows/sync-reusable.yml
    secrets: inherit
    with:
      npm-sync-script: 'sync-update'
      branch-name: 'automated/update'
      commit-message: 'chore(dependents): update npm data'
      pr-title: 'chore(dependents): update npm data'
      pr-body: |
        The dependents data is outdated and needs to be updated.

        This PR contains updated dependents data. Verify that everything looks alright and that tests passes, then merge.

        _Do not push to this PR. It's handled by [a workflow](/${{ github.repository }}/actions/runs/${{ github.run_id }}) which keeps it up to date at a schedule._
